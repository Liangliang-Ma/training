[2024-02-28 23:24:46,620] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to xpu (auto detect)
could not open any host key
ssh_keysign: no reply
sign using hostkey ssh-ed25519 SHA256:A2W4lNPcOoKo7omPDL4wGkCaq4d9EEhM1BwN4wf2ZTM failed
[2024-02-28 23:24:48,422] [INFO] [runner.py:463:main] Using IP address of 172.16.1.23 for node compute23
[2024-02-28 23:24:48,424] [INFO] [runner.py:568:main] cmd = mpirun -n 8 -ppn 8 -hostfile hostfile_mpich -genv PYTHONSTARTUP=/etc/pythonstart -genv PYTHONPATH=/home/maliangl/ft/reference/llama2_70b_lora -genv MASTER_ADDR 172.16.1.23 -genv MASTER_PORT 29500 -genv WORLD_SIZE 8 -genv LOCAL_SIZE 8 -hosts compute23 /home/maliangl/miniconda3/envs/ft/bin/python -u /home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/deepspeed/launcher/launcher_helper.py --launcher mpich scripts/train.py --model_path /scratch/users/maliangl/Llama-2-70b-hf --dataset_name tau/scrolls --dataset_config_name gov_report --max_seq_len 2048 --bf16 True --logging_steps 2 --save_steps 999 --output_dir ./results/llama-70b_scrolls_gov_report_r16_666 --per_device_train_batch_size 1 --gradient_accumulation_steps 1 --lr_scheduler_type cosine --learning_rate 5e-4 --warmup_ratio 0 --use_gradient_checkpointing True --target_eval_loss 0.925 --use_peft_lora True --lora_r 16 --lora_alpha 16 --lora_dropout 0.1 --max_steps 800 --seed 666 --lora_target_modules qkv_proj,o_proj
My guessed rank = 5
My guessed rank = 7
My guessed rank = 4
My guessed rank = 6
My guessed rank = 3
My guessed rank = 0
My guessed rank = 1
My guessed rank = 2
[2024-02-28 23:24:53,384] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to xpu (auto detect)
[2024-02-28 23:24:53,384] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to xpu (auto detect)
[2024-02-28 23:24:53,384] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to xpu (auto detect)
[2024-02-28 23:24:53,384] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to xpu (auto detect)
[2024-02-28 23:24:53,384] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to xpu (auto detect)
[2024-02-28 23:24:53,390] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to xpu (auto detect)
[2024-02-28 23:24:53,405] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to xpu (auto detect)
[2024-02-28 23:24:53,411] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to xpu (auto detect)
[2024-02-28 23:24:53,803] [INFO] [launcher_helper.py:101:main] launcher_helper cmd = /home/maliangl/miniconda3/envs/ft/bin/python -u scripts/train.py --model_path /scratch/users/maliangl/Llama-2-70b-hf --dataset_name tau/scrolls --dataset_config_name gov_report --max_seq_len 2048 --bf16 True --logging_steps 2 --save_steps 999 --output_dir ./results/llama-70b_scrolls_gov_report_r16_666 --per_device_train_batch_size 1 --gradient_accumulation_steps 1 --lr_scheduler_type cosine --learning_rate 5e-4 --warmup_ratio 0 --use_gradient_checkpointing True --target_eval_loss 0.925 --use_peft_lora True --lora_r 16 --lora_alpha 16 --lora_dropout 0.1 --max_steps 800 --seed 666 --lora_target_modules qkv_proj,o_proj
[2024-02-28 23:24:53,803] [INFO] [launcher_helper.py:101:main] launcher_helper cmd = /home/maliangl/miniconda3/envs/ft/bin/python -u scripts/train.py --model_path /scratch/users/maliangl/Llama-2-70b-hf --dataset_name tau/scrolls --dataset_config_name gov_report --max_seq_len 2048 --bf16 True --logging_steps 2 --save_steps 999 --output_dir ./results/llama-70b_scrolls_gov_report_r16_666 --per_device_train_batch_size 1 --gradient_accumulation_steps 1 --lr_scheduler_type cosine --learning_rate 5e-4 --warmup_ratio 0 --use_gradient_checkpointing True --target_eval_loss 0.925 --use_peft_lora True --lora_r 16 --lora_alpha 16 --lora_dropout 0.1 --max_steps 800 --seed 666 --lora_target_modules qkv_proj,o_proj
[2024-02-28 23:24:53,803] [INFO] [launcher_helper.py:101:main] launcher_helper cmd = /home/maliangl/miniconda3/envs/ft/bin/python -u scripts/train.py --model_path /scratch/users/maliangl/Llama-2-70b-hf --dataset_name tau/scrolls --dataset_config_name gov_report --max_seq_len 2048 --bf16 True --logging_steps 2 --save_steps 999 --output_dir ./results/llama-70b_scrolls_gov_report_r16_666 --per_device_train_batch_size 1 --gradient_accumulation_steps 1 --lr_scheduler_type cosine --learning_rate 5e-4 --warmup_ratio 0 --use_gradient_checkpointing True --target_eval_loss 0.925 --use_peft_lora True --lora_r 16 --lora_alpha 16 --lora_dropout 0.1 --max_steps 800 --seed 666 --lora_target_modules qkv_proj,o_proj
[2024-02-28 23:24:53,803] [INFO] [launcher_helper.py:101:main] launcher_helper cmd = /home/maliangl/miniconda3/envs/ft/bin/python -u scripts/train.py --model_path /scratch/users/maliangl/Llama-2-70b-hf --dataset_name tau/scrolls --dataset_config_name gov_report --max_seq_len 2048 --bf16 True --logging_steps 2 --save_steps 999 --output_dir ./results/llama-70b_scrolls_gov_report_r16_666 --per_device_train_batch_size 1 --gradient_accumulation_steps 1 --lr_scheduler_type cosine --learning_rate 5e-4 --warmup_ratio 0 --use_gradient_checkpointing True --target_eval_loss 0.925 --use_peft_lora True --lora_r 16 --lora_alpha 16 --lora_dropout 0.1 --max_steps 800 --seed 666 --lora_target_modules qkv_proj,o_proj
[2024-02-28 23:24:53,803] [INFO] [launcher_helper.py:101:main] launcher_helper cmd = /home/maliangl/miniconda3/envs/ft/bin/python -u scripts/train.py --model_path /scratch/users/maliangl/Llama-2-70b-hf --dataset_name tau/scrolls --dataset_config_name gov_report --max_seq_len 2048 --bf16 True --logging_steps 2 --save_steps 999 --output_dir ./results/llama-70b_scrolls_gov_report_r16_666 --per_device_train_batch_size 1 --gradient_accumulation_steps 1 --lr_scheduler_type cosine --learning_rate 5e-4 --warmup_ratio 0 --use_gradient_checkpointing True --target_eval_loss 0.925 --use_peft_lora True --lora_r 16 --lora_alpha 16 --lora_dropout 0.1 --max_steps 800 --seed 666 --lora_target_modules qkv_proj,o_proj
[2024-02-28 23:24:53,803] [INFO] [launcher_helper.py:101:main] launcher_helper cmd = /home/maliangl/miniconda3/envs/ft/bin/python -u scripts/train.py --model_path /scratch/users/maliangl/Llama-2-70b-hf --dataset_name tau/scrolls --dataset_config_name gov_report --max_seq_len 2048 --bf16 True --logging_steps 2 --save_steps 999 --output_dir ./results/llama-70b_scrolls_gov_report_r16_666 --per_device_train_batch_size 1 --gradient_accumulation_steps 1 --lr_scheduler_type cosine --learning_rate 5e-4 --warmup_ratio 0 --use_gradient_checkpointing True --target_eval_loss 0.925 --use_peft_lora True --lora_r 16 --lora_alpha 16 --lora_dropout 0.1 --max_steps 800 --seed 666 --lora_target_modules qkv_proj,o_proj
[2024-02-28 23:24:53,803] [INFO] [launcher_helper.py:101:main] launcher_helper cmd = /home/maliangl/miniconda3/envs/ft/bin/python -u scripts/train.py --model_path /scratch/users/maliangl/Llama-2-70b-hf --dataset_name tau/scrolls --dataset_config_name gov_report --max_seq_len 2048 --bf16 True --logging_steps 2 --save_steps 999 --output_dir ./results/llama-70b_scrolls_gov_report_r16_666 --per_device_train_batch_size 1 --gradient_accumulation_steps 1 --lr_scheduler_type cosine --learning_rate 5e-4 --warmup_ratio 0 --use_gradient_checkpointing True --target_eval_loss 0.925 --use_peft_lora True --lora_r 16 --lora_alpha 16 --lora_dropout 0.1 --max_steps 800 --seed 666 --lora_target_modules qkv_proj,o_proj
[2024-02-28 23:24:53,803] [INFO] [launcher_helper.py:101:main] launcher_helper cmd = /home/maliangl/miniconda3/envs/ft/bin/python -u scripts/train.py --model_path /scratch/users/maliangl/Llama-2-70b-hf --dataset_name tau/scrolls --dataset_config_name gov_report --max_seq_len 2048 --bf16 True --logging_steps 2 --save_steps 999 --output_dir ./results/llama-70b_scrolls_gov_report_r16_666 --per_device_train_batch_size 1 --gradient_accumulation_steps 1 --lr_scheduler_type cosine --learning_rate 5e-4 --warmup_ratio 0 --use_gradient_checkpointing True --target_eval_loss 0.925 --use_peft_lora True --lora_r 16 --lora_alpha 16 --lora_dropout 0.1 --max_steps 800 --seed 666 --lora_target_modules qkv_proj,o_proj
My guessed rank = 4
My guessed rank = 6
My guessed rank = 7
My guessed rank = 0
My guessed rank = 1
My guessed rank = 2
My guessed rank = 5
My guessed rank = 3
[2024-02-28 23:24:59,323] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to xpu (auto detect)
[2024-02-28 23:24:59,327] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to xpu (auto detect)
[2024-02-28 23:24:59,360] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to xpu (auto detect)
[2024-02-28 23:24:59,366] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to xpu (auto detect)
[2024-02-28 23:24:59,369] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to xpu (auto detect)
[2024-02-28 23:24:59,371] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to xpu (auto detect)
[2024-02-28 23:24:59,373] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to xpu (auto detect)
[2024-02-28 23:24:59,375] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to xpu (auto detect)
[2024-02-28 23:24:59,636] [INFO] [comm.py:161:init_deepspeed_backend] Initialize ccl backend
[2024-02-28 23:24:59,636] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-02-28 23:24:59,870] [INFO] [comm.py:161:init_deepspeed_backend] Initialize ccl backend
[2024-02-28 23:24:59,870] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-02-28 23:24:59,988] [INFO] [comm.py:161:init_deepspeed_backend] Initialize ccl backend
[2024-02-28 23:24:59,988] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-02-28 23:25:00,005] [INFO] [comm.py:161:init_deepspeed_backend] Initialize ccl backend
[2024-02-28 23:25:00,005] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-02-28 23:25:00,008] [INFO] [comm.py:161:init_deepspeed_backend] Initialize ccl backend
[2024-02-28 23:25:00,008] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-02-28 23:25:00,008] [INFO] [comm.py:161:init_deepspeed_backend] Initialize ccl backend
[2024-02-28 23:25:00,008] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-02-28 23:25:00,008] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend ccl
[2024-02-28 23:25:00,010] [INFO] [comm.py:161:init_deepspeed_backend] Initialize ccl backend
[2024-02-28 23:25:00,010] [INFO] [comm.py:161:init_deepspeed_backend] Initialize ccl backend
[2024-02-28 23:25:00,010] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-02-28 23:25:00,010] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-02-28 23:25:10,150] [INFO] [partition_parameters.py:343:__exit__] finished initializing model - num_params = 723, num_elems = 68.98B
Loading checkpoint shards:   0%|          | 0/15 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/15 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/15 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/15 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/15 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/15 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/15 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/15 [00:00<?, ?it/s]/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Loading checkpoint shards:   7%|▋         | 1/15 [00:11<02:38, 11.33s/it]Loading checkpoint shards:   7%|▋         | 1/15 [00:11<02:38, 11.33s/it]Loading checkpoint shards:   7%|▋         | 1/15 [00:11<02:38, 11.33s/it]Loading checkpoint shards:   7%|▋         | 1/15 [00:11<02:38, 11.33s/it]Loading checkpoint shards:   7%|▋         | 1/15 [00:11<02:38, 11.34s/it]Loading checkpoint shards:   7%|▋         | 1/15 [00:11<02:38, 11.34s/it]Loading checkpoint shards:   7%|▋         | 1/15 [00:11<02:38, 11.34s/it]Loading checkpoint shards:   7%|▋         | 1/15 [00:11<02:38, 11.36s/it]Loading checkpoint shards:  13%|█▎        | 2/15 [00:21<02:18, 10.64s/it]Loading checkpoint shards:  13%|█▎        | 2/15 [00:21<02:18, 10.64s/it]Loading checkpoint shards:  13%|█▎        | 2/15 [00:21<02:18, 10.64s/it]Loading checkpoint shards:  13%|█▎        | 2/15 [00:21<02:18, 10.64s/it]Loading checkpoint shards:  13%|█▎        | 2/15 [00:21<02:18, 10.64s/it]Loading checkpoint shards:  13%|█▎        | 2/15 [00:21<02:18, 10.64s/it]Loading checkpoint shards:  13%|█▎        | 2/15 [00:21<02:18, 10.64s/it]Loading checkpoint shards:  13%|█▎        | 2/15 [00:21<02:18, 10.64s/it]Loading checkpoint shards:  20%|██        | 3/15 [00:32<02:08, 10.74s/it]Loading checkpoint shards:  20%|██        | 3/15 [00:32<02:08, 10.74s/it]Loading checkpoint shards:  20%|██        | 3/15 [00:32<02:08, 10.74s/it]Loading checkpoint shards:  20%|██        | 3/15 [00:32<02:08, 10.74s/it]Loading checkpoint shards:  20%|██        | 3/15 [00:32<02:08, 10.74s/it]Loading checkpoint shards:  20%|██        | 3/15 [00:32<02:08, 10.74s/it]Loading checkpoint shards:  20%|██        | 3/15 [00:32<02:08, 10.74s/it]Loading checkpoint shards:  20%|██        | 3/15 [00:32<02:08, 10.74s/it]Loading checkpoint shards:  27%|██▋       | 4/15 [00:43<01:58, 10.77s/it]Loading checkpoint shards:  27%|██▋       | 4/15 [00:43<01:58, 10.77s/it]Loading checkpoint shards:  27%|██▋       | 4/15 [00:43<01:58, 10.77s/it]Loading checkpoint shards:  27%|██▋       | 4/15 [00:43<01:58, 10.77s/it]Loading checkpoint shards:  27%|██▋       | 4/15 [00:43<01:58, 10.77s/it]Loading checkpoint shards:  27%|██▋       | 4/15 [00:43<01:58, 10.77s/it]Loading checkpoint shards:  27%|██▋       | 4/15 [00:43<01:58, 10.77s/it]Loading checkpoint shards:  27%|██▋       | 4/15 [00:43<01:58, 10.77s/it]Loading checkpoint shards:  33%|███▎      | 5/15 [00:53<01:47, 10.77s/it]Loading checkpoint shards:  33%|███▎      | 5/15 [00:53<01:47, 10.77s/it]Loading checkpoint shards:  33%|███▎      | 5/15 [00:53<01:47, 10.77s/it]Loading checkpoint shards:  33%|███▎      | 5/15 [00:53<01:47, 10.77s/it]Loading checkpoint shards:  33%|███▎      | 5/15 [00:53<01:47, 10.77s/it]Loading checkpoint shards:  33%|███▎      | 5/15 [00:53<01:47, 10.77s/it]Loading checkpoint shards:  33%|███▎      | 5/15 [00:53<01:47, 10.77s/it]Loading checkpoint shards:  33%|███▎      | 5/15 [00:53<01:47, 10.78s/it]Loading checkpoint shards:  40%|████      | 6/15 [01:04<01:36, 10.76s/it]Loading checkpoint shards:  40%|████      | 6/15 [01:04<01:36, 10.76s/it]Loading checkpoint shards:  40%|████      | 6/15 [01:04<01:36, 10.76s/it]Loading checkpoint shards:  40%|████      | 6/15 [01:04<01:36, 10.76s/it]Loading checkpoint shards:  40%|████      | 6/15 [01:04<01:36, 10.76s/it]Loading checkpoint shards:  40%|████      | 6/15 [01:04<01:36, 10.76s/it]Loading checkpoint shards:  40%|████      | 6/15 [01:04<01:36, 10.76s/it]Loading checkpoint shards:  40%|████      | 6/15 [01:04<01:36, 10.76s/it]Loading checkpoint shards:  47%|████▋     | 7/15 [01:15<01:27, 10.88s/it]Loading checkpoint shards:  47%|████▋     | 7/15 [01:15<01:27, 10.88s/it]Loading checkpoint shards:  47%|████▋     | 7/15 [01:15<01:27, 10.88s/it]Loading checkpoint shards:  47%|████▋     | 7/15 [01:15<01:27, 10.88s/it]Loading checkpoint shards:  47%|████▋     | 7/15 [01:15<01:27, 10.88s/it]Loading checkpoint shards:  47%|████▋     | 7/15 [01:15<01:27, 10.88s/it]Loading checkpoint shards:  47%|████▋     | 7/15 [01:15<01:27, 10.88s/it]Loading checkpoint shards:  47%|████▋     | 7/15 [01:15<01:27, 10.88s/it]Loading checkpoint shards:  53%|█████▎    | 8/15 [01:26<01:16, 10.91s/it]Loading checkpoint shards:  53%|█████▎    | 8/15 [01:26<01:16, 10.91s/it]Loading checkpoint shards:  53%|█████▎    | 8/15 [01:26<01:16, 10.91s/it]Loading checkpoint shards:  53%|█████▎    | 8/15 [01:26<01:16, 10.91s/it]Loading checkpoint shards:  53%|█████▎    | 8/15 [01:26<01:16, 10.91s/it]Loading checkpoint shards:  53%|█████▎    | 8/15 [01:26<01:16, 10.91s/it]Loading checkpoint shards:  53%|█████▎    | 8/15 [01:26<01:16, 10.91s/it]Loading checkpoint shards:  53%|█████▎    | 8/15 [01:26<01:16, 10.91s/it]Loading checkpoint shards:  60%|██████    | 9/15 [01:37<01:05, 10.86s/it]Loading checkpoint shards:  60%|██████    | 9/15 [01:37<01:05, 10.86s/it]Loading checkpoint shards:  60%|██████    | 9/15 [01:37<01:05, 10.86s/it]Loading checkpoint shards:  60%|██████    | 9/15 [01:37<01:05, 10.86s/it]Loading checkpoint shards:  60%|██████    | 9/15 [01:37<01:05, 10.86s/it]Loading checkpoint shards:  60%|██████    | 9/15 [01:37<01:05, 10.86s/it]Loading checkpoint shards:  60%|██████    | 9/15 [01:37<01:05, 10.86s/it]Loading checkpoint shards:  60%|██████    | 9/15 [01:37<01:05, 10.86s/it]Loading checkpoint shards:  67%|██████▋   | 10/15 [01:48<00:54, 10.86s/it]Loading checkpoint shards:  67%|██████▋   | 10/15 [01:48<00:54, 10.86s/it]Loading checkpoint shards:  67%|██████▋   | 10/15 [01:48<00:54, 10.86s/it]Loading checkpoint shards:  67%|██████▋   | 10/15 [01:48<00:54, 10.86s/it]Loading checkpoint shards:  67%|██████▋   | 10/15 [01:48<00:54, 10.86s/it]Loading checkpoint shards:  67%|██████▋   | 10/15 [01:48<00:54, 10.86s/it]Loading checkpoint shards:  67%|██████▋   | 10/15 [01:48<00:54, 10.86s/it]Loading checkpoint shards:  67%|██████▋   | 10/15 [01:48<00:54, 10.86s/it]Loading checkpoint shards:  73%|███████▎  | 11/15 [01:59<00:43, 10.94s/it]Loading checkpoint shards:  73%|███████▎  | 11/15 [01:59<00:43, 10.94s/it]Loading checkpoint shards:  73%|███████▎  | 11/15 [01:59<00:43, 10.94s/it]Loading checkpoint shards:  73%|███████▎  | 11/15 [01:59<00:43, 10.94s/it]Loading checkpoint shards:  73%|███████▎  | 11/15 [01:59<00:43, 10.94s/it]Loading checkpoint shards:  73%|███████▎  | 11/15 [01:59<00:43, 10.94s/it]Loading checkpoint shards:  73%|███████▎  | 11/15 [01:59<00:43, 10.94s/it]Loading checkpoint shards:  73%|███████▎  | 11/15 [01:59<00:43, 10.94s/it]Loading checkpoint shards:  80%|████████  | 12/15 [02:10<00:32, 10.88s/it]Loading checkpoint shards:  80%|████████  | 12/15 [02:10<00:32, 10.89s/it]Loading checkpoint shards:  80%|████████  | 12/15 [02:10<00:32, 10.89s/it]Loading checkpoint shards:  80%|████████  | 12/15 [02:10<00:32, 10.89s/it]Loading checkpoint shards:  80%|████████  | 12/15 [02:10<00:32, 10.89s/it]Loading checkpoint shards:  80%|████████  | 12/15 [02:10<00:32, 10.89s/it]Loading checkpoint shards:  80%|████████  | 12/15 [02:10<00:32, 10.89s/it]Loading checkpoint shards:  80%|████████  | 12/15 [02:10<00:32, 10.89s/it]Loading checkpoint shards:  87%|████████▋ | 13/15 [02:20<00:21, 10.83s/it]Loading checkpoint shards:  87%|████████▋ | 13/15 [02:20<00:21, 10.83s/it]Loading checkpoint shards:  87%|████████▋ | 13/15 [02:20<00:21, 10.83s/it]Loading checkpoint shards:  87%|████████▋ | 13/15 [02:20<00:21, 10.83s/it]Loading checkpoint shards:  87%|████████▋ | 13/15 [02:20<00:21, 10.83s/it]Loading checkpoint shards:  87%|████████▋ | 13/15 [02:20<00:21, 10.83s/it]Loading checkpoint shards:  87%|████████▋ | 13/15 [02:20<00:21, 10.83s/it]Loading checkpoint shards:  87%|████████▋ | 13/15 [02:20<00:21, 10.83s/it]Loading checkpoint shards:  93%|█████████▎| 14/15 [02:31<00:10, 10.85s/it]Loading checkpoint shards:  93%|█████████▎| 14/15 [02:31<00:10, 10.85s/it]Loading checkpoint shards:  93%|█████████▎| 14/15 [02:31<00:10, 10.85s/it]Loading checkpoint shards:  93%|█████████▎| 14/15 [02:31<00:10, 10.85s/it]Loading checkpoint shards:  93%|█████████▎| 14/15 [02:31<00:10, 10.85s/it]Loading checkpoint shards:  93%|█████████▎| 14/15 [02:31<00:10, 10.85s/it]Loading checkpoint shards:  93%|█████████▎| 14/15 [02:31<00:10, 10.85s/it]Loading checkpoint shards:  93%|█████████▎| 14/15 [02:31<00:10, 10.85s/it]Loading checkpoint shards: 100%|██████████| 15/15 [02:32<00:00,  7.79s/it]Loading checkpoint shards: 100%|██████████| 15/15 [02:32<00:00, 10.17s/it]
Loading checkpoint shards: 100%|██████████| 15/15 [02:32<00:00,  7.79s/it]Loading checkpoint shards: 100%|██████████| 15/15 [02:32<00:00,  7.79s/it]Loading checkpoint shards: 100%|██████████| 15/15 [02:32<00:00,  7.79s/it]Loading checkpoint shards: 100%|██████████| 15/15 [02:32<00:00, 10.17s/it]
Loading checkpoint shards: 100%|██████████| 15/15 [02:32<00:00, 10.17s/it]
Loading checkpoint shards: 100%|██████████| 15/15 [02:32<00:00, 10.17s/it]
Loading checkpoint shards: 100%|██████████| 15/15 [02:32<00:00,  7.79s/it]Loading checkpoint shards: 100%|██████████| 15/15 [02:32<00:00, 10.17s/it]
Loading checkpoint shards: 100%|██████████| 15/15 [02:32<00:00,  7.79s/it]Loading checkpoint shards: 100%|██████████| 15/15 [02:32<00:00, 10.17s/it]
Loading checkpoint shards: 100%|██████████| 15/15 [02:32<00:00,  7.79s/it]Loading checkpoint shards: 100%|██████████| 15/15 [02:32<00:00, 10.17s/it]
Loading checkpoint shards: 100%|██████████| 15/15 [02:32<00:00,  7.79s/it]Loading checkpoint shards: 100%|██████████| 15/15 [02:32<00:00, 10.17s/it]
trainable params: 20,971,520 || all params: 68,997,619,712 || trainable%: 0.03039455576516454
trainable params: 20,971,520 || all params: 68,997,619,712 || trainable%: 0.03039455576516454
trainable params: 20,971,520 || all params: 68,997,619,712 || trainable%: 0.03039455576516454
trainable params: 20,971,520 || all params: 68,997,619,712 || trainable%: 0.03039455576516454
trainable params: 20,971,520 || all params: 68,997,619,712 || trainable%: 0.03039455576516454
trainable params: 20,971,520 || all params: 68,997,619,712 || trainable%: 0.03039455576516454
trainable params: 20,971,520 || all params: 68,997,619,712 || trainable%: 0.03039455576516454
trainable params: 20,971,520 || all params: 68,997,619,712 || trainable%: 0.03039455576516454
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/datasets/load.py:2508: FutureWarning: 'use_auth_token' was deprecated in favor of 'token' in version 2.14.0 and will be removed in 3.0.0.
You can remove this warning by passing 'token=<use_auth_token>' instead.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/datasets/load.py:2508: FutureWarning: 'use_auth_token' was deprecated in favor of 'token' in version 2.14.0 and will be removed in 3.0.0.
You can remove this warning by passing 'token=<use_auth_token>' instead.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/datasets/load.py:2508: FutureWarning: 'use_auth_token' was deprecated in favor of 'token' in version 2.14.0 and will be removed in 3.0.0.
You can remove this warning by passing 'token=<use_auth_token>' instead.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/datasets/load.py:2508: FutureWarning: 'use_auth_token' was deprecated in favor of 'token' in version 2.14.0 and will be removed in 3.0.0.
You can remove this warning by passing 'token=<use_auth_token>' instead.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/datasets/load.py:2508: FutureWarning: 'use_auth_token' was deprecated in favor of 'token' in version 2.14.0 and will be removed in 3.0.0.
You can remove this warning by passing 'token=<use_auth_token>' instead.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/datasets/load.py:2508: FutureWarning: 'use_auth_token' was deprecated in favor of 'token' in version 2.14.0 and will be removed in 3.0.0.
You can remove this warning by passing 'token=<use_auth_token>' instead.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/datasets/load.py:2508: FutureWarning: 'use_auth_token' was deprecated in favor of 'token' in version 2.14.0 and will be removed in 3.0.0.
You can remove this warning by passing 'token=<use_auth_token>' instead.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/datasets/load.py:2508: FutureWarning: 'use_auth_token' was deprecated in favor of 'token' in version 2.14.0 and will be removed in 3.0.0.
You can remove this warning by passing 'token=<use_auth_token>' instead.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/datasets/load.py:1454: FutureWarning: The repository for tau/scrolls contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/tau/scrolls
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/datasets/load.py:1454: FutureWarning: The repository for tau/scrolls contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/tau/scrolls
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/datasets/load.py:1454: FutureWarning: The repository for tau/scrolls contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/tau/scrolls
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/datasets/load.py:1454: FutureWarning: The repository for tau/scrolls contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/tau/scrolls
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/datasets/load.py:1454: FutureWarning: The repository for tau/scrolls contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/tau/scrolls
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/datasets/load.py:1454: FutureWarning: The repository for tau/scrolls contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/tau/scrolls
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/datasets/load.py:1454: FutureWarning: The repository for tau/scrolls contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/tau/scrolls
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/datasets/load.py:1454: FutureWarning: The repository for tau/scrolls contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/tau/scrolls
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
Map (num_proc=8):   0%|          | 0/17457 [00:00<?, ? examples/s]Map (num_proc=8):   0%|          | 0/17457 [00:00<?, ? examples/s]Map (num_proc=8):   0%|          | 0/17457 [00:00<?, ? examples/s]Map (num_proc=8):   0%|          | 0/17457 [00:00<?, ? examples/s]Map (num_proc=8):   0%|          | 0/17457 [00:00<?, ? examples/s]Map (num_proc=8):   0%|          | 0/17457 [00:00<?, ? examples/s]Map (num_proc=8):   0%|          | 0/17457 [00:00<?, ? examples/s]Map (num_proc=8):   0%|          | 0/17457 [00:00<?, ? examples/s]Map (num_proc=8):   6%|▌         | 1000/17457 [00:31<08:32, 32.12 examples/s]Map (num_proc=8):   6%|▌         | 1000/17457 [00:31<08:33, 32.02 examples/s]Map (num_proc=8):   6%|▌         | 1000/17457 [00:31<08:34, 31.98 examples/s]Map (num_proc=8):  11%|█▏        | 2000/17457 [00:31<03:19, 77.48 examples/s]Map (num_proc=8):  11%|█▏        | 2000/17457 [00:31<03:19, 77.35 examples/s]Map (num_proc=8):   6%|▌         | 1000/17457 [00:31<08:36, 31.89 examples/s]Map (num_proc=8):   6%|▌         | 1000/17457 [00:31<08:36, 31.88 examples/s]Map (num_proc=8):   6%|▌         | 1000/17457 [00:31<08:36, 31.87 examples/s]Map (num_proc=8):  11%|█▏        | 2000/17457 [00:31<03:20, 77.12 examples/s]Map (num_proc=8):   6%|▌         | 1000/17457 [00:31<08:37, 31.79 examples/s]Map (num_proc=8):   6%|▌         | 1000/17457 [00:31<08:38, 31.72 examples/s]Map (num_proc=8):  11%|█▏        | 2000/17457 [00:31<03:21, 76.88 examples/s]Map (num_proc=8):  11%|█▏        | 2000/17457 [00:31<03:21, 76.63 examples/s]Map (num_proc=8):  11%|█▏        | 2000/17457 [00:31<03:22, 76.30 examples/s]Map (num_proc=8):  17%|█▋        | 3000/17457 [00:32<01:48, 133.61 examples/s]Map (num_proc=8):  17%|█▋        | 3000/17457 [00:32<01:47, 133.87 examples/s]Map (num_proc=8):  17%|█▋        | 3000/17457 [00:32<01:48, 133.32 examples/s]Map (num_proc=8):  23%|██▎       | 4000/17457 [00:32<01:01, 217.97 examples/s]Map (num_proc=8):  17%|█▋        | 3000/17457 [00:32<01:48, 133.41 examples/s]Map (num_proc=8):  23%|██▎       | 4000/17457 [00:32<01:01, 218.36 examples/s]Map (num_proc=8):  17%|█▋        | 3000/17457 [00:32<01:48, 133.09 examples/s]Map (num_proc=8):  17%|█▋        | 3000/17457 [00:32<02:03, 117.04 examples/s]Map (num_proc=8):  17%|█▋        | 3000/17457 [00:32<01:48, 133.21 examples/s]Map (num_proc=8):  23%|██▎       | 4000/17457 [00:32<01:02, 217.00 examples/s]Map (num_proc=8):  29%|██▊       | 5000/17457 [00:32<00:37, 335.69 examples/s]Map (num_proc=8):  23%|██▎       | 4000/17457 [00:32<01:01, 218.00 examples/s]Map (num_proc=8):  23%|██▎       | 4000/17457 [00:32<01:02, 216.93 examples/s]Map (num_proc=8):  17%|█▋        | 3000/17457 [00:32<02:04, 116.15 examples/s]Map (num_proc=8):  23%|██▎       | 4000/17457 [00:32<01:02, 216.80 examples/s]Map (num_proc=8):  23%|██▎       | 4000/17457 [00:32<01:16, 176.47 examples/s]Map (num_proc=8):  29%|██▊       | 5000/17457 [00:32<00:37, 333.14 examples/s]Map (num_proc=8):  29%|██▊       | 5000/17457 [00:32<00:37, 328.29 examples/s]Map (num_proc=8):  29%|██▊       | 5000/17457 [00:32<00:47, 260.38 examples/s]Map (num_proc=8):  34%|███▍      | 6000/17457 [00:33<00:25, 442.87 examples/s]Map (num_proc=8):  34%|███▍      | 6000/17457 [00:33<00:25, 451.87 examples/s]Map (num_proc=8):  34%|███▍      | 6000/17457 [00:33<00:27, 412.36 examples/s]Map (num_proc=8):  34%|███▍      | 6000/17457 [00:33<00:27, 410.53 examples/s]Map (num_proc=8):  34%|███▍      | 6000/17457 [00:33<00:40, 283.09 examples/s]Map (num_proc=8):  34%|███▍      | 6000/17457 [00:33<00:27, 410.80 examples/s]Map (num_proc=8):  34%|███▍      | 6000/17457 [00:33<00:25, 443.15 examples/s]Map (num_proc=8):  34%|███▍      | 6000/17457 [00:33<00:32, 348.63 examples/s]Map (num_proc=8):  40%|████      | 7000/17457 [00:33<00:21, 494.65 examples/s]Map (num_proc=8):  40%|████      | 7000/17457 [00:33<00:19, 544.17 examples/s]Map (num_proc=8):  40%|████      | 7000/17457 [00:33<00:19, 534.45 examples/s]Map (num_proc=8):  40%|████      | 7000/17457 [00:33<00:19, 530.49 examples/s]Map (num_proc=8):  40%|████      | 7000/17457 [00:34<00:17, 584.55 examples/s]Map (num_proc=8):  40%|████      | 7000/17457 [00:34<00:17, 598.95 examples/s]Map (num_proc=8):  40%|████      | 7000/17457 [00:34<00:17, 601.30 examples/s]Map (num_proc=8):  40%|████      | 7000/17457 [00:34<00:29, 350.54 examples/s]Map (num_proc=8):  46%|████▌     | 8000/17457 [00:35<00:23, 403.22 examples/s]Map (num_proc=8):  46%|████▌     | 8000/17457 [00:35<00:15, 610.89 examples/s]Map (num_proc=8):  46%|████▌     | 8000/17457 [00:35<00:15, 615.64 examples/s]Map (num_proc=8):  46%|████▌     | 8000/17457 [00:35<00:17, 555.95 examples/s]Map (num_proc=8):  46%|████▌     | 8000/17457 [00:35<00:17, 549.88 examples/s]Map (num_proc=8):  46%|████▌     | 8000/17457 [00:35<00:17, 546.68 examples/s]Map (num_proc=8):  46%|████▌     | 8000/17457 [00:35<00:18, 511.39 examples/s]Map (num_proc=8):  46%|████▌     | 8000/17457 [00:35<00:15, 605.09 examples/s]Map (num_proc=8):  46%|████▌     | 8000/17457 [00:54<00:17, 555.95 examples/s]Map (num_proc=8):  46%|████▌     | 8000/17457 [00:54<00:17, 549.88 examples/s]Map (num_proc=8):  46%|████▌     | 8000/17457 [00:54<00:15, 615.64 examples/s]Map (num_proc=8):  46%|████▌     | 8000/17457 [00:54<00:23, 403.22 examples/s]Map (num_proc=8):  46%|████▌     | 8000/17457 [00:54<00:17, 546.68 examples/s]Map (num_proc=8):  46%|████▌     | 8000/17457 [00:54<00:18, 511.39 examples/s]Map (num_proc=8):  46%|████▌     | 8000/17457 [00:54<00:15, 610.89 examples/s]Map (num_proc=8):  46%|████▌     | 8000/17457 [00:54<00:15, 605.09 examples/s]Map (num_proc=8):  52%|█████▏    | 9000/17457 [01:03<01:23, 100.78 examples/s]Map (num_proc=8):  57%|█████▋    | 10000/17457 [01:03<00:51, 143.82 examples/s]Map (num_proc=8):  52%|█████▏    | 9000/17457 [01:04<01:19, 105.92 examples/s]Map (num_proc=8):  52%|█████▏    | 9000/17457 [01:04<01:25, 98.71 examples/s] Map (num_proc=8):  52%|█████▏    | 9000/17457 [01:04<01:20, 105.00 examples/s]Map (num_proc=8):  57%|█████▋    | 10000/17457 [01:04<00:50, 146.53 examples/s]Map (num_proc=8):  52%|█████▏    | 9000/17457 [01:04<01:18, 107.12 examples/s]Map (num_proc=8):  52%|█████▏    | 9000/17457 [01:04<01:21, 104.39 examples/s]Map (num_proc=8):  57%|█████▋    | 10000/17457 [01:04<00:52, 140.76 examples/s]Map (num_proc=8):  52%|█████▏    | 9000/17457 [01:04<01:26, 98.22 examples/s] Map (num_proc=8):  52%|█████▏    | 9000/17457 [01:04<01:25, 98.45 examples/s] Map (num_proc=8):  63%|██████▎   | 11000/17457 [01:05<00:33, 191.54 examples/s]Map (num_proc=8):  63%|██████▎   | 11000/17457 [01:05<00:35, 181.41 examples/s]Map (num_proc=8):  63%|██████▎   | 11000/17457 [01:05<00:36, 177.96 examples/s]Map (num_proc=8):  63%|██████▎   | 11000/17457 [01:05<00:35, 180.08 examples/s]Map (num_proc=8):  63%|██████▎   | 11000/17457 [01:05<00:36, 177.10 examples/s]Map (num_proc=8):  63%|██████▎   | 11000/17457 [01:05<00:33, 190.18 examples/s]Map (num_proc=8):  63%|██████▎   | 11000/17457 [01:06<00:37, 173.24 examples/s]Map (num_proc=8):  63%|██████▎   | 11000/17457 [01:06<00:35, 181.75 examples/s]Map (num_proc=8):  69%|██████▊   | 12000/17457 [01:07<00:24, 224.75 examples/s]Map (num_proc=8):  74%|███████▍  | 13000/17457 [01:08<00:13, 318.98 examples/s]Map (num_proc=8):  69%|██████▊   | 12000/17457 [01:08<00:23, 230.87 examples/s]Map (num_proc=8):  69%|██████▊   | 12000/17457 [01:08<00:26, 204.32 examples/s]Map (num_proc=8):  69%|██████▊   | 12000/17457 [01:08<00:26, 208.50 examples/s]Map (num_proc=8):  80%|████████  | 14000/17457 [01:08<00:07, 444.63 examples/s]Map (num_proc=8):  74%|███████▍  | 13000/17457 [01:08<00:13, 322.38 examples/s]Map (num_proc=8):  69%|██████▊   | 12000/17457 [01:08<00:26, 206.72 examples/s]Map (num_proc=8):  74%|███████▍  | 13000/17457 [01:08<00:16, 269.29 examples/s]Map (num_proc=8):  69%|██████▊   | 12000/17457 [01:08<00:26, 206.83 examples/s]Map (num_proc=8):  69%|██████▊   | 12000/17457 [01:08<00:26, 204.48 examples/s]Map (num_proc=8):  69%|██████▊   | 12000/17457 [01:08<00:24, 223.51 examples/s]Map (num_proc=8):  74%|███████▍  | 13000/17457 [01:08<00:16, 274.53 examples/s]Map (num_proc=8):  74%|███████▍  | 13000/17457 [01:08<00:16, 274.95 examples/s]Map (num_proc=8):  80%|████████  | 14000/17457 [01:08<00:09, 366.79 examples/s]Map (num_proc=8):  86%|████████▌ | 15000/17457 [01:08<00:05, 457.37 examples/s]Map (num_proc=8):  80%|████████  | 14000/17457 [01:08<00:08, 397.11 examples/s]Map (num_proc=8):  86%|████████▌ | 15000/17457 [01:09<00:04, 540.34 examples/s]Map (num_proc=8):  80%|████████  | 14000/17457 [01:09<00:10, 336.82 examples/s]Map (num_proc=8):  86%|████████▌ | 15000/17457 [01:09<00:06, 401.32 examples/s]Map (num_proc=8):  86%|████████▌ | 15000/17457 [01:09<00:04, 518.78 examples/s]Map (num_proc=8):  86%|████████▌ | 15000/17457 [01:09<00:05, 425.35 examples/s]Map (num_proc=8):  86%|████████▌ | 15000/17457 [01:09<00:05, 487.91 examples/s]Map (num_proc=8):  86%|████████▌ | 15000/17457 [01:09<00:04, 525.98 examples/s]Map (num_proc=8):  86%|████████▌ | 15000/17457 [01:09<00:05, 424.85 examples/s]Map (num_proc=8):  88%|████████▊ | 15365/17457 [01:09<00:03, 537.03 examples/s]Map (num_proc=8):  88%|████████▊ | 15365/17457 [01:10<00:04, 489.80 examples/s]Map (num_proc=8):  88%|████████▊ | 15365/17457 [01:10<00:05, 387.69 examples/s]Map (num_proc=8):  88%|████████▊ | 15365/17457 [01:10<00:05, 416.94 examples/s]Map (num_proc=8):  88%|████████▊ | 15365/17457 [01:10<00:04, 440.22 examples/s]Map (num_proc=8):  88%|████████▊ | 15365/17457 [01:10<00:05, 400.77 examples/s]Map (num_proc=8):  88%|████████▊ | 15365/17457 [01:10<00:05, 402.97 examples/s]Map (num_proc=8):  94%|█████████▎| 16365/17457 [01:10<00:02, 535.94 examples/s]Map (num_proc=8):  94%|█████████▎| 16365/17457 [01:10<00:01, 575.40 examples/s]Map (num_proc=8):  94%|█████████▎| 16365/17457 [01:10<00:01, 636.49 examples/s]Map (num_proc=8):  94%|█████████▎| 16365/17457 [01:10<00:02, 477.69 examples/s]Map (num_proc=8):  94%|█████████▎| 16365/17457 [01:11<00:01, 595.87 examples/s]Map (num_proc=8):  94%|█████████▎| 16365/17457 [01:11<00:02, 527.60 examples/s]Map (num_proc=8):  94%|█████████▎| 16365/17457 [01:11<00:01, 586.43 examples/s]Map (num_proc=8):  94%|█████████▎| 16365/17457 [01:11<00:02, 521.09 examples/s]Map (num_proc=8):  95%|█████████▍| 16547/17457 [01:11<00:02, 436.96 examples/s]Map (num_proc=8):  95%|█████████▍| 16547/17457 [01:12<00:01, 506.88 examples/s]Map (num_proc=8):  95%|█████████▍| 16547/17457 [01:12<00:02, 434.72 examples/s]Map (num_proc=8):  96%|█████████▌| 16729/17457 [01:14<00:02, 350.57 examples/s]Map (num_proc=8):  96%|█████████▌| 16729/17457 [01:14<00:02, 360.92 examples/s]Map (num_proc=8):  96%|█████████▌| 16729/17457 [01:14<00:02, 315.96 examples/s]Map (num_proc=8):  96%|█████████▌| 16729/17457 [01:14<00:01, 383.50 examples/s]Map (num_proc=8):  96%|█████████▌| 16729/17457 [01:14<00:02, 355.46 examples/s]Map (num_proc=8):  96%|█████████▌| 16729/17457 [01:14<00:02, 339.94 examples/s]Map (num_proc=8):  97%|█████████▋| 16911/17457 [01:14<00:01, 380.78 examples/s]Map (num_proc=8):  97%|█████████▋| 16911/17457 [01:14<00:01, 361.77 examples/s]Map (num_proc=8):  96%|█████████▌| 16729/17457 [01:14<00:02, 340.73 examples/s]Map (num_proc=8):  97%|█████████▋| 16911/17457 [01:14<00:01, 318.30 examples/s]Map (num_proc=8):  96%|█████████▌| 16729/17457 [01:14<00:02, 300.81 examples/s]Map (num_proc=8):  98%|█████████▊| 17093/17457 [01:15<00:00, 377.06 examples/s]Map (num_proc=8):  98%|█████████▊| 17093/17457 [01:15<00:00, 364.59 examples/s]Map (num_proc=8):  97%|█████████▋| 16911/17457 [01:15<00:01, 342.64 examples/s]Map (num_proc=8):  98%|█████████▊| 17093/17457 [01:15<00:01, 359.25 examples/s]Map (num_proc=8):  97%|█████████▋| 16911/17457 [01:15<00:01, 347.38 examples/s]Map (num_proc=8):  98%|█████████▊| 17093/17457 [01:15<00:01, 358.17 examples/s]Map (num_proc=8):  98%|█████████▊| 17093/17457 [01:15<00:01, 332.76 examples/s]Map (num_proc=8):  98%|█████████▊| 17093/17457 [01:15<00:00, 384.29 examples/s]Map (num_proc=8):  98%|█████████▊| 17093/17457 [01:15<00:00, 376.37 examples/s]Map (num_proc=8):  99%|█████████▉| 17275/17457 [01:15<00:00, 368.74 examples/s]Map (num_proc=8):  99%|█████████▉| 17275/17457 [01:15<00:00, 386.83 examples/s]Map (num_proc=8):  99%|█████████▉| 17275/17457 [01:15<00:00, 421.22 examples/s]Map (num_proc=8):  99%|█████████▉| 17275/17457 [01:15<00:00, 369.69 examples/s]Map (num_proc=8):  99%|█████████▉| 17275/17457 [01:15<00:00, 382.59 examples/s]Map (num_proc=8):  99%|█████████▉| 17275/17457 [01:15<00:00, 390.49 examples/s]Map (num_proc=8):  99%|█████████▉| 17275/17457 [01:15<00:00, 374.73 examples/s]Map (num_proc=8):  99%|█████████▉| 17275/17457 [01:15<00:00, 398.49 examples/s]Map (num_proc=8): 100%|██████████| 17457/17457 [01:16<00:00, 335.96 examples/s]Map (num_proc=8): 100%|██████████| 17457/17457 [01:16<00:00, 320.09 examples/s]Map (num_proc=8): 100%|██████████| 17457/17457 [01:16<00:00, 362.17 examples/s]Map (num_proc=8): 100%|██████████| 17457/17457 [01:16<00:00, 307.57 examples/s]Map (num_proc=8): 100%|██████████| 17457/17457 [01:16<00:00, 296.55 examples/s]Map (num_proc=8): 100%|██████████| 17457/17457 [01:16<00:00, 305.14 examples/s]Map (num_proc=8): 100%|██████████| 17457/17457 [01:16<00:00, 327.07 examples/s]Map (num_proc=8): 100%|██████████| 17457/17457 [01:16<00:00, 315.72 examples/s]Map (num_proc=8): 100%|██████████| 17457/17457 [01:18<00:00, 222.61 examples/s]
Map (num_proc=8): 100%|██████████| 17457/17457 [01:18<00:00, 222.64 examples/s]
Map (num_proc=8): 100%|██████████| 17457/17457 [01:18<00:00, 222.54 examples/s]
Map (num_proc=8): 100%|██████████| 17457/17457 [01:18<00:00, 222.52 examples/s]
Map (num_proc=8): 100%|██████████| 17457/17457 [01:18<00:00, 222.53 examples/s]
Map (num_proc=8): 100%|██████████| 17457/17457 [01:18<00:00, 222.53 examples/s]
Map (num_proc=8): 100%|██████████| 17457/17457 [01:18<00:00, 222.51 examples/s]
Map (num_proc=8): 100%|██████████| 17457/17457 [01:18<00:00, 222.51 examples/s]
Map (num_proc=2):   0%|          | 0/972 [00:00<?, ? examples/s]Map (num_proc=2):   0%|          | 0/972 [00:00<?, ? examples/s]Map (num_proc=2):   0%|          | 0/972 [00:00<?, ? examples/s]Map (num_proc=2):   0%|          | 0/972 [00:00<?, ? examples/s]Map (num_proc=2):   0%|          | 0/972 [00:00<?, ? examples/s]Map (num_proc=2):   0%|          | 0/972 [00:00<?, ? examples/s]Map (num_proc=2):   0%|          | 0/972 [00:00<?, ? examples/s]Map (num_proc=2):   0%|          | 0/972 [00:00<?, ? examples/s]Map (num_proc=2):  50%|█████     | 486/972 [00:29<00:29, 16.35 examples/s]Map (num_proc=2):  50%|█████     | 486/972 [00:29<00:29, 16.32 examples/s]Map (num_proc=2):  50%|█████     | 486/972 [00:29<00:29, 16.23 examples/s]Map (num_proc=2):  50%|█████     | 486/972 [00:29<00:29, 16.22 examples/s]Map (num_proc=2):  50%|█████     | 486/972 [00:30<00:30, 16.18 examples/s]Map (num_proc=2):  50%|█████     | 486/972 [00:30<00:30, 16.18 examples/s]Map (num_proc=2):  50%|█████     | 486/972 [00:29<00:29, 16.20 examples/s]Map (num_proc=2):  50%|█████     | 486/972 [00:30<00:30, 16.18 examples/s]Map (num_proc=2): 100%|██████████| 972/972 [00:30<00:00, 37.92 examples/s]Map (num_proc=2): 100%|██████████| 972/972 [00:30<00:00, 37.83 examples/s]Map (num_proc=2): 100%|██████████| 972/972 [00:30<00:00, 37.55 examples/s]Map (num_proc=2): 100%|██████████| 972/972 [00:30<00:00, 37.75 examples/s]Map (num_proc=2): 100%|██████████| 972/972 [00:31<00:00, 37.48 examples/s]Map (num_proc=2): 100%|██████████| 972/972 [00:31<00:00, 37.37 examples/s]Map (num_proc=2): 100%|██████████| 972/972 [00:31<00:00, 31.18 examples/s]
Filter (num_proc=8):   0%|          | 0/17457 [00:00<?, ? examples/s]Map (num_proc=2): 100%|██████████| 972/972 [00:31<00:00, 30.92 examples/s]
Map (num_proc=2): 100%|██████████| 972/972 [00:31<00:00, 30.91 examples/s]
Map (num_proc=2): 100%|██████████| 972/972 [00:31<00:00, 36.81 examples/s]Map (num_proc=2): 100%|██████████| 972/972 [00:31<00:00, 30.87 examples/s]
Map (num_proc=2): 100%|██████████| 972/972 [00:31<00:00, 36.57 examples/s]Filter (num_proc=8):   0%|          | 0/17457 [00:00<?, ? examples/s]Filter (num_proc=8):   0%|          | 0/17457 [00:00<?, ? examples/s]Map (num_proc=2): 100%|██████████| 972/972 [00:31<00:00, 30.74 examples/s]
Filter (num_proc=8):   0%|          | 0/17457 [00:00<?, ? examples/s]Map (num_proc=2): 100%|██████████| 972/972 [00:31<00:00, 30.68 examples/s]
Filter (num_proc=8):   0%|          | 0/17457 [00:00<?, ? examples/s]Filter (num_proc=8):   0%|          | 0/17457 [00:00<?, ? examples/s]Map (num_proc=2): 100%|██████████| 972/972 [00:31<00:00, 30.50 examples/s]
Map (num_proc=2): 100%|██████████| 972/972 [00:32<00:00, 30.34 examples/s]
Filter (num_proc=8):   0%|          | 0/17457 [00:00<?, ? examples/s]Filter (num_proc=8):   0%|          | 0/17457 [00:00<?, ? examples/s]Filter (num_proc=8):   6%|▌         | 1000/17457 [00:03<00:52, 311.74 examples/s]Filter (num_proc=8):  23%|██▎       | 4000/17457 [00:03<00:08, 1575.54 examples/s]Filter (num_proc=8):   6%|▌         | 1000/17457 [00:03<00:52, 312.87 examples/s]Filter (num_proc=8):  46%|████▌     | 8000/17457 [00:03<00:02, 3566.33 examples/s]Filter (num_proc=8):  23%|██▎       | 4000/17457 [00:03<00:08, 1577.03 examples/s]Filter (num_proc=8):   6%|▌         | 1000/17457 [00:03<00:54, 303.10 examples/s]Filter (num_proc=8):   6%|▌         | 1000/17457 [00:03<00:53, 309.67 examples/s]Filter (num_proc=8):  17%|█▋        | 3000/17457 [00:03<00:13, 1109.87 examples/s]Filter (num_proc=8):   6%|▌         | 1000/17457 [00:03<00:52, 310.82 examples/s]Filter (num_proc=8):  17%|█▋        | 3000/17457 [00:03<00:12, 1132.44 examples/s]Filter (num_proc=8):  40%|████      | 7000/17457 [00:03<00:03, 2981.95 examples/s]Filter (num_proc=8):  23%|██▎       | 4000/17457 [00:03<00:08, 1570.37 examples/s]Filter (num_proc=8):  29%|██▊       | 5000/17457 [00:03<00:05, 2193.20 examples/s]Filter (num_proc=8):   6%|▌         | 1000/17457 [00:03<00:54, 303.57 examples/s]Filter (num_proc=8):  29%|██▊       | 5000/17457 [00:03<00:05, 2081.42 examples/s]Filter (num_proc=8):  40%|████      | 7000/17457 [00:03<00:02, 3494.27 examples/s]Filter (num_proc=8):  40%|████      | 7000/17457 [00:03<00:03, 3338.89 examples/s]Filter (num_proc=8):  29%|██▊       | 5000/17457 [00:03<00:06, 1932.76 examples/s]Filter (num_proc=8):  46%|████▌     | 8000/17457 [00:03<00:02, 3556.84 examples/s]Filter (num_proc=8):   6%|▌         | 1000/17457 [00:03<00:54, 303.98 examples/s]Filter (num_proc=8):   6%|▌         | 1000/17457 [00:03<00:53, 307.02 examples/s]Filter (num_proc=8):  46%|████▌     | 8000/17457 [00:03<00:02, 3367.23 examples/s]Filter (num_proc=8):  34%|███▍      | 6000/17457 [00:03<00:04, 2341.90 examples/s]Filter (num_proc=8):  29%|██▊       | 5000/17457 [00:03<00:06, 1959.58 examples/s]Filter (num_proc=8):  46%|████▌     | 8000/17457 [00:03<00:02, 3495.00 examples/s]Filter (num_proc=8):  57%|█████▋    | 10000/17457 [00:06<00:04, 1567.14 examples/s]Filter (num_proc=8):  52%|█████▏    | 9000/17457 [00:06<00:05, 1455.59 examples/s]Filter (num_proc=8):  69%|██████▊   | 12000/17457 [00:06<00:02, 2099.93 examples/s]Filter (num_proc=8):  52%|█████▏    | 9000/17457 [00:06<00:05, 1420.02 examples/s]Filter (num_proc=8):  52%|█████▏    | 9000/17457 [00:06<00:06, 1408.96 examples/s]Filter (num_proc=8):  63%|██████▎   | 11000/17457 [00:06<00:03, 2016.42 examples/s]Filter (num_proc=8):  92%|█████████▏| 16000/17457 [00:06<00:00, 3656.63 examples/s]Filter (num_proc=8):  69%|██████▊   | 12000/17457 [00:06<00:02, 2337.87 examples/s]Filter (num_proc=8):  57%|█████▋    | 10000/17457 [00:06<00:04, 1572.29 examples/s]Filter (num_proc=8):  57%|█████▋    | 10000/17457 [00:06<00:04, 1636.76 examples/s]Filter (num_proc=8):  63%|██████▎   | 11000/17457 [00:06<00:03, 1973.69 examples/s]Filter (num_proc=8):  57%|█████▋    | 10000/17457 [00:06<00:04, 1526.94 examples/s]Filter (num_proc=8):  81%|████████  | 14183/17457 [00:06<00:00, 3285.93 examples/s]Filter (num_proc=8):  69%|██████▊   | 12000/17457 [00:06<00:02, 2348.41 examples/s]Filter (num_proc=8):  69%|██████▊   | 12000/17457 [00:06<00:02, 2118.52 examples/s]Filter (num_proc=8):  52%|█████▏    | 9000/17457 [00:06<00:05, 1487.92 examples/s]Filter (num_proc=8):  74%|███████▍  | 13000/17457 [00:06<00:01, 2849.89 examples/s]Filter (num_proc=8):  69%|██████▊   | 12000/17457 [00:06<00:02, 2060.52 examples/s]Filter (num_proc=8):  81%|████████  | 14183/17457 [00:06<00:00, 3426.45 examples/s]Filter (num_proc=8):  94%|█████████▎| 16365/17457 [00:07<00:00, 4392.47 examples/s]Filter (num_proc=8):  87%|████████▋ | 15182/17457 [00:07<00:00, 3941.34 examples/s]Filter (num_proc=8):  92%|█████████▏| 16000/17457 [00:06<00:00, 3589.99 examples/s]Filter (num_proc=8):  63%|██████▎   | 11000/17457 [00:06<00:03, 1982.19 examples/s]Filter (num_proc=8):  86%|████████▌ | 15000/17457 [00:06<00:00, 3238.74 examples/s]Filter (num_proc=8):  88%|████████▊ | 15365/17457 [00:07<00:00, 4085.40 examples/s]Filter (num_proc=8): 100%|██████████| 17457/17457 [00:07<00:00, 2356.50 examples/s]
Filter (num_proc=8):  63%|██████▎   | 11000/17457 [00:06<00:03, 1688.11 examples/s]Filter (num_proc=2):   0%|          | 0/972 [00:00<?, ? examples/s]Filter (num_proc=8):  80%|████████  | 14000/17457 [00:06<00:01, 3032.70 examples/s]Filter (num_proc=8):  80%|████████  | 14000/17457 [00:06<00:01, 2565.70 examples/s]Filter (num_proc=8):  95%|█████████▍| 16547/17457 [00:07<00:00, 4159.42 examples/s]Filter (num_proc=8):  95%|█████████▍| 16547/17457 [00:07<00:00, 4357.41 examples/s]Filter (num_proc=8):  93%|█████████▎| 16182/17457 [00:06<00:00, 3780.44 examples/s]Filter (num_proc=8):  93%|█████████▎| 16183/17457 [00:06<00:00, 3263.73 examples/s]Filter (num_proc=8):  95%|█████████▍| 16547/17457 [00:07<00:00, 3318.77 examples/s]Filter (num_proc=8): 100%|██████████| 17457/17457 [00:07<00:00, 3559.69 examples/s]Filter (num_proc=8): 100%|██████████| 17457/17457 [00:07<00:00, 3377.44 examples/s]Filter (num_proc=8): 100%|██████████| 17457/17457 [00:07<00:00, 2290.61 examples/s]
Filter (num_proc=8): 100%|██████████| 17457/17457 [00:07<00:00, 2344.41 examples/s]
Filter (num_proc=2):   0%|          | 0/972 [00:00<?, ? examples/s]Filter (num_proc=2):   0%|          | 0/972 [00:00<?, ? examples/s]Filter (num_proc=8): 100%|██████████| 17457/17457 [00:07<00:00, 2250.55 examples/s]
Filter (num_proc=8): 100%|██████████| 17457/17457 [00:07<00:00, 2270.27 examples/s]
Filter (num_proc=8): 100%|██████████| 17457/17457 [00:07<00:00, 2322.00 examples/s]
Filter (num_proc=2):   0%|          | 0/972 [00:00<?, ? examples/s]Filter (num_proc=2):   0%|          | 0/972 [00:00<?, ? examples/s]Filter (num_proc=2):   0%|          | 0/972 [00:00<?, ? examples/s]Filter (num_proc=8): 100%|██████████| 17457/17457 [00:07<00:00, 2339.67 examples/s]
Filter (num_proc=8): 100%|██████████| 17457/17457 [00:07<00:00, 2346.30 examples/s]
Filter (num_proc=2):   0%|          | 0/972 [00:00<?, ? examples/s]Filter (num_proc=2):   0%|          | 0/972 [00:00<?, ? examples/s]Filter (num_proc=2):  50%|█████     | 486/972 [00:01<00:01, 292.54 examples/s]Filter (num_proc=2): 100%|██████████| 972/972 [00:01<00:00, 644.52 examples/s]Filter (num_proc=2): 100%|██████████| 972/972 [00:01<00:00, 525.32 examples/s]
Before packing, Size of the train set: 68. Size of the validation set: 4
Map (num_proc=8):   0%|          | 0/68 [00:00<?, ? examples/s]Map (num_proc=8): 100%|██████████| 68/68 [00:00<00:00, 523.17 examples/s]
Map (num_proc=2):   0%|          | 0/4 [00:00<?, ? examples/s]Filter (num_proc=2):  50%|█████     | 486/972 [00:01<00:01, 292.90 examples/s]Filter (num_proc=2):  50%|█████     | 486/972 [00:01<00:01, 291.80 examples/s]Map (num_proc=2): 100%|██████████| 4/4 [00:00<00:00, 38.02 examples/s]
Size of the train set: 46. Size of the validation set: 2
Filter (num_proc=2): 100%|██████████| 972/972 [00:01<00:00, 652.40 examples/s]Filter (num_proc=2): 100%|██████████| 972/972 [00:01<00:00, 529.45 examples/s]
Before packing, Size of the train set: 68. Size of the validation set: 4
Filter (num_proc=2):  50%|█████     | 486/972 [00:01<00:01, 286.09 examples/s]Filter (num_proc=2):  50%|█████     | 486/972 [00:01<00:01, 287.00 examples/s]Filter (num_proc=2):  50%|█████     | 486/972 [00:01<00:01, 291.55 examples/s]Size of the train set: 46. Size of the validation set: 2
Filter (num_proc=2): 100%|██████████| 972/972 [00:01<00:00, 530.11 examples/s]
trainable params: 20,971,520 || all params: 68,997,619,712 || trainable%: 0.03039455576516454
Before packing, Size of the train set: 68. Size of the validation set: 4
prepare all done!
Size of the train set: 46. Size of the validation set: 2
Filter (num_proc=2): 100%|██████████| 972/972 [00:01<00:00, 640.42 examples/s]trainable params: 20,971,520 || all params: 68,997,619,712 || trainable%: 0.03039455576516454
Filter (num_proc=2): 100%|██████████| 972/972 [00:01<00:00, 640.93 examples/s]prepare all done!
Filter (num_proc=2):  50%|█████     | 486/972 [00:01<00:01, 295.25 examples/s]trainable params: 20,971,520 || all params: 68,997,619,712 || trainable%: 0.03039455576516454
prepare all done!
Filter (num_proc=2): 100%|██████████| 972/972 [00:01<00:00, 519.79 examples/s]
Filter (num_proc=2): 100%|██████████| 972/972 [00:01<00:00, 530.08 examples/s]
Filter (num_proc=2): 100%|██████████| 972/972 [00:01<00:00, 520.85 examples/s]
Before packing, Size of the train set: 68. Size of the validation set: 4
Before packing, Size of the train set: 68. Size of the validation set: 4
Before packing, Size of the train set: 68. Size of the validation set: 4
Size of the train set: 46. Size of the validation set: 2
Size of the train set: 46. Size of the validation set: 2
Size of the train set: 46. Size of the validation set: 2
Filter (num_proc=2):  50%|█████     | 486/972 [00:01<00:01, 284.78 examples/s]Filter (num_proc=2): 100%|██████████| 972/972 [00:01<00:00, 651.46 examples/s]mll zero 3
trainable params: 20,971,520 || all params: 68,997,619,712 || trainable%: 0.03039455576516454
trainable params: 20,971,520 || all params: 68,997,619,712 || trainable%: 0.03039455576516454
trainable params: 20,971,520 || all params: 68,997,619,712 || trainable%: 0.03039455576516454
prepare all done!
prepare all done!
prepare all done!
Filter (num_proc=2): 100%|██████████| 972/972 [00:01<00:00, 530.91 examples/s]
mll zero 3
Before packing, Size of the train set: 68. Size of the validation set: 4
mll zero 3
Size of the train set: 46. Size of the validation set: 2
Filter (num_proc=2): 100%|██████████| 972/972 [00:01<00:00, 520.89 examples/s]
PeftModelForCausalLM(
  (base_model): LoraModel(
    (model): LlamaForCausalLM(
      (model): LlamaModel(
        (embed_tokens): Embedding(32000, 8192, padding_idx=0)
        (layers): ModuleList(
          (0-79): 80 x LlamaDecoderLayer(
            (self_attn): LlamaAttention(
              (q_proj): Linear(in_features=8192, out_features=8192, bias=False)
              (k_proj): Linear(in_features=8192, out_features=1024, bias=False)
              (v_proj): Linear(in_features=8192, out_features=1024, bias=False)
              (o_proj): lora.Linear(
                (base_layer): Linear(in_features=8192, out_features=8192, bias=False)
                (lora_dropout): ModuleDict(
                  (default): Dropout(p=0.1, inplace=False)
                )
                (lora_A): ModuleDict(
                  (default): Linear(in_features=8192, out_features=16, bias=False)
                )
                (lora_B): ModuleDict(
                  (default): Linear(in_features=16, out_features=8192, bias=False)
                )
                (lora_embedding_A): ParameterDict()
                (lora_embedding_B): ParameterDict()
              )
              (rotary_emb): LlamaRotaryEmbedding()
            )
            (mlp): LlamaMLP(
              (gate_proj): Linear(in_features=8192, out_features=28672, bias=False)
              (up_proj): Linear(in_features=8192, out_features=28672, bias=False)
              (down_proj): Linear(in_features=28672, out_features=8192, bias=False)
              (act_fn): SiLU()
            )
            (input_layernorm): LlamaRMSNorm()
            (post_attention_layernorm): LlamaRMSNorm()
          )
        )
        (norm): LlamaRMSNorm()
      )
      (lm_head): Linear(in_features=8192, out_features=32000, bias=False)
    )
  )
)
Before packing, Size of the train set: 68. Size of the validation set: 4
trainable params: 20,971,520 || all params: 68,997,619,712 || trainable%: 0.03039455576516454
prepare all done!
Size of the train set: 46. Size of the validation set: 2
mll zero 3
mll zero 3
mll zero 3
trainable params: 20,971,520 || all params: 68,997,619,712 || trainable%: 0.03039455576516454
prepare all done!
mll zero 3
mll zero 3
Parameter Offload: Total persistent parameters: 1318912 in 161 params
:::MLLOG {"namespace": "", "time_ms": 1709191789341, "event_type": "POINT_IN_TIME", "key": "submission_benchmark", "value": "llama2_70b_lora", "metadata": {"file": "mlperf_logging_utils.py", "lineno": 92}}
:::MLLOG {"namespace": "", "time_ms": 1709191789342, "event_type": "POINT_IN_TIME", "key": "submission_division", "value": "Closed", "metadata": {"file": "mlperf_logging_utils.py", "lineno": 96}}
:::MLLOG {"namespace": "", "time_ms": 1709191789342, "event_type": "POINT_IN_TIME", "key": "submission_org", "value": "referece", "metadata": {"file": "mlperf_logging_utils.py", "lineno": 100}}
:::MLLOG {"namespace": "", "time_ms": 1709191789342, "event_type": "POINT_IN_TIME", "key": "submission_platform", "value": "referece", "metadata": {"file": "mlperf_logging_utils.py", "lineno": 103}}
:::MLLOG {"namespace": "", "time_ms": 1709191789342, "event_type": "POINT_IN_TIME", "key": "submission_poc_name", "value": "referece", "metadata": {"file": "mlperf_logging_utils.py", "lineno": 107}}
:::MLLOG {"namespace": "", "time_ms": 1709191789342, "event_type": "POINT_IN_TIME", "key": "submission_poc_email", "value": "referece", "metadata": {"file": "mlperf_logging_utils.py", "lineno": 111}}
:::MLLOG {"namespace": "", "time_ms": 1709191789343, "event_type": "POINT_IN_TIME", "key": "submission_status", "value": "referece", "metadata": {"file": "mlperf_logging_utils.py", "lineno": 115}}
:::MLLOG {"namespace": "", "time_ms": 1709191789343, "event_type": "POINT_IN_TIME", "key": "global_batch_size", "value": "8", "metadata": {"file": "mlperf_logging_utils.py", "lineno": 119}}
:::MLLOG {"namespace": "", "time_ms": 1709191789343, "event_type": "POINT_IN_TIME", "key": "train_samples", "value": 46, "metadata": {"file": "mlperf_logging_utils.py", "lineno": 125}}
:::MLLOG {"namespace": "", "time_ms": 1709191789343, "event_type": "POINT_IN_TIME", "key": "eval_samples", "value": 2, "metadata": {"file": "mlperf_logging_utils.py", "lineno": 129}}
:::MLLOG {"namespace": "", "time_ms": 1709191789343, "event_type": "POINT_IN_TIME", "key": "seed", "value": 666, "metadata": {"file": "mlperf_logging_utils.py", "lineno": 133}}
:::MLLOG {"namespace": "", "time_ms": 1709191789343, "event_type": "POINT_IN_TIME", "key": "opt_learning_rate_warmup_factor", "value": 0.0, "metadata": {"file": "mlperf_logging_utils.py", "lineno": 134}}
:::MLLOG {"namespace": "", "time_ms": 1709191789343, "event_type": "POINT_IN_TIME", "key": "opt_learning_rate_training_steps", "value": 800, "metadata": {"file": "mlperf_logging_utils.py", "lineno": 135}}
:::MLLOG {"namespace": "", "time_ms": 1709191789343, "event_type": "POINT_IN_TIME", "key": "opt_base_learning_rate", "value": 0.0005, "metadata": {"file": "mlperf_logging_utils.py", "lineno": 136}}
:::MLLOG {"namespace": "", "time_ms": 1709191789343, "event_type": "POINT_IN_TIME", "key": "gradient_accumulation_steps", "value": 1, "metadata": {"file": "mlperf_logging_utils.py", "lineno": 138}}
:::MLLOG {"namespace": "", "time_ms": 1709191789343, "event_type": "INTERVAL_START", "key": "run_start", "value": "", "metadata": {"file": "mlperf_logging_utils.py", "lineno": 139}}
  0%|          | 0/800 [00:00<?, ?it/s]/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/home/maliangl/miniconda3/envs/ft/lib/python3.9/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
  0%|          | 1/800 [00:28<6:13:20, 28.04s/it]  0%|          | 2/800 [00:41<4:15:29, 19.21s/it]                                                 {'loss': 1.2135, 'learning_rate': 0.0004999922894111975, 'epoch': 0.33}
  0%|          | 2/800 [00:41<4:15:29, 19.21s/it]:::MLLOG {"namespace": "", "time_ms": 1709191830422, "event_type": "POINT_IN_TIME", "key": "train_loss", "value": 1.2135, "metadata": {"file": "mlperf_logging_utils.py", "lineno": 157, "step_num": 2}}
  0%|          | 3/800 [00:54<3:37:37, 16.38s/it]                                                 {'loss': 1.2993, 'learning_rate': 0.0004999826512866693, 'epoch': 0.5}
  0%|          | 3/800 [00:54<3:37:37, 16.38s/it]  0%|          | 4/800 [01:07<3:19:43, 15.05s/it]                                                 {'loss': 1.2684, 'learning_rate': 0.0004999691581204152, 'epoch': 0.67}
  0%|          | 4/800 [01:07<3:19:43, 15.05s/it]:::MLLOG {"namespace": "", "time_ms": 1709191856458, "event_type": "POINT_IN_TIME", "key": "train_loss", "value": 1.2684, "metadata": {"file": "mlperf_logging_utils.py", "lineno": 157, "step_num": 4}}
  1%|          | 5/800 [01:20<3:09:51, 14.33s/it]                                                 {'loss': 1.311, 'learning_rate': 0.0004999518101205162, 'epoch': 0.83}
  1%|          | 5/800 [01:20<3:09:51, 14.33s/it]  1%|          | 6/800 [01:33<3:03:53, 13.90s/it]                                                 {'loss': 1.2095, 'learning_rate': 0.0004999306075545002, 'epoch': 1.0}
  1%|          | 6/800 [01:33<3:03:53, 13.90s/it]:::MLLOG {"namespace": "", "time_ms": 1709191882560, "event_type": "POINT_IN_TIME", "key": "train_loss", "value": 1.2095, "metadata": {"file": "mlperf_logging_utils.py", "lineno": 157, "step_num": 6}}
  1%|          | 7/800 [01:46<3:00:08, 13.63s/it]                                                 {'loss': 1.2693, 'learning_rate': 0.0004999055507493368, 'epoch': 1.17}
  1%|          | 7/800 [01:46<3:00:08, 13.63s/it]  1%|          | 8/800 [01:59<2:57:35, 13.45s/it]                                                 {'loss': 1.1693, 'learning_rate': 0.0004998766400914329, 'epoch': 1.33}
  1%|          | 8/800 [01:59<2:57:35, 13.45s/it]:::MLLOG {"namespace": "", "time_ms": 1709191908715, "event_type": "POINT_IN_TIME", "key": "train_loss", "value": 1.1693, "metadata": {"file": "mlperf_logging_utils.py", "lineno": 157, "step_num": 8}}
  1%|          | 9/800 [02:12<2:55:49, 13.34s/it]                                                 {'loss': 1.0916, 'learning_rate': 0.0004998438760266267, 'epoch': 1.5}
  1%|          | 9/800 [02:12<2:55:49, 13.34s/it]  1%|▏         | 10/800 [02:25<2:54:31, 13.26s/it]                                                  {'loss': 1.2721, 'learning_rate': 0.0004998072590601808, 'epoch': 1.67}
  1%|▏         | 10/800 [02:25<2:54:31, 13.26s/it]:::MLLOG {"namespace": "", "time_ms": 1709191934874, "event_type": "POINT_IN_TIME", "key": "train_loss", "value": 1.2721, "metadata": {"file": "mlperf_logging_utils.py", "lineno": 157, "step_num": 10}}
  1%|▏         | 11/800 [02:38<2:53:35, 13.20s/it]                                                  {'loss': 1.1733, 'learning_rate': 0.0004997667897567738, 'epoch': 1.83}
  1%|▏         | 11/800 [02:38<2:53:35, 13.20s/it]  2%|▏         | 12/800 [02:51<2:52:53, 13.16s/it]                                                  {'loss': 1.1381, 'learning_rate': 0.0004997224687404926, 'epoch': 2.0}
  2%|▏         | 12/800 [02:51<2:52:53, 13.16s/it]:::MLLOG {"namespace": "", "time_ms": 1709191961028, "event_type": "POINT_IN_TIME", "key": "train_loss", "value": 1.1381, "metadata": {"file": "mlperf_logging_utils.py", "lineno": 157, "step_num": 12}}
  2%|▏         | 13/800 [03:04<2:52:20, 13.14s/it]                                                  {'loss': 1.1548, 'learning_rate': 0.0004996742966948219, 'epoch': 2.17}
  2%|▏         | 13/800 [03:04<2:52:20, 13.14s/it]  2%|▏         | 14/800 [03:17<2:51:53, 13.12s/it]                                                  {'loss': 1.1394, 'learning_rate': 0.0004996222743626345, 'epoch': 2.33}
  2%|▏         | 14/800 [03:17<2:51:53, 13.12s/it]:::MLLOG {"namespace": "", "time_ms": 1709191987191, "event_type": "POINT_IN_TIME", "key": "train_loss", "value": 1.1394, "metadata": {"file": "mlperf_logging_utils.py", "lineno": 157, "step_num": 14}}
  2%|▏         | 15/800 [03:30<2:51:31, 13.11s/it]                                                  {'loss': 1.1252, 'learning_rate': 0.000499566402546179, 'epoch': 2.5}
  2%|▏         | 15/800 [03:30<2:51:31, 13.11s/it]  2%|▏         | 16/800 [03:43<2:51:11, 13.10s/it]                                                  {'loss': 1.1598, 'learning_rate': 0.0004995066821070679, 'epoch': 2.67}
  2%|▏         | 16/800 [03:44<2:51:11, 13.10s/it]:::MLLOG {"namespace": "", "time_ms": 1709192013350, "event_type": "POINT_IN_TIME", "key": "train_loss", "value": 1.1598, "metadata": {"file": "mlperf_logging_utils.py", "lineno": 157, "step_num": 16}}
  2%|▏         | 17/800 [03:57<2:50:57, 13.10s/it]                                                  {'loss': 1.0519, 'learning_rate': 0.0004994431139662643, 'epoch': 2.83}
  2%|▏         | 17/800 [03:57<2:50:57, 13.10s/it]  2%|▏         | 18/800 [04:10<2:50:42, 13.10s/it]                                                  {'loss': 1.0821, 'learning_rate': 0.0004993756991040675, 'epoch': 3.0}
  2%|▏         | 18/800 [04:10<2:50:42, 13.10s/it]:::MLLOG {"namespace": "", "time_ms": 1709192039546, "event_type": "POINT_IN_TIME", "key": "train_loss", "value": 1.0821, "metadata": {"file": "mlperf_logging_utils.py", "lineno": 157, "step_num": 18}}
  2%|▏         | 19/800 [04:23<2:50:26, 13.09s/it]                                                  {'loss': 1.0881, 'learning_rate': 0.0004993044385600982, 'epoch': 3.17}
  2%|▏         | 19/800 [04:23<2:50:26, 13.09s/it]  2%|▎         | 20/800 [04:36<2:50:09, 13.09s/it]                                                  {'loss': 1.057, 'learning_rate': 0.000499229333433282, 'epoch': 3.33}
  2%|▎         | 20/800 [04:36<2:50:09, 13.09s/it]:::MLLOG {"namespace": "", "time_ms": 1709192065708, "event_type": "POINT_IN_TIME", "key": "train_loss", "value": 1.057, "metadata": {"file": "mlperf_logging_utils.py", "lineno": 157, "step_num": 20}}
  3%|▎         | 21/800 [04:49<2:49:54, 13.09s/it]                                                  {'loss': 1.0546, 'learning_rate': 0.000499150384881833, 'epoch': 3.5}
  3%|▎         | 21/800 [04:49<2:49:54, 13.09s/it]  3%|▎         | 22/800 [05:02<2:49:40, 13.08s/it]                                                  {'loss': 0.9393, 'learning_rate': 0.0004990675941232354, 'epoch': 3.67}
  3%|▎         | 22/800 [05:02<2:49:40, 13.08s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
                                     [A                                                  {'eval_loss': 0.4212236702442169, 'eval_runtime': 5.143, 'eval_samples_per_second': 0.389, 'eval_steps_per_second': 0.194, 'epoch': 3.67}

100%|██████████| 1/1 [00:00<00:00, 54.32it/s][A  3%|▎         | 22/800 [05:07<2:49:40, 13.08s/it]
                                             [A:::MLLOG {"namespace": "", "time_ms": 1709192097031, "event_type": "INTERVAL_END", "key": "block_stop", "value": "", "metadata": {"file": "mlperf_logging_utils.py", "lineno": 165, "step_num": 22}}
:::MLLOG {"namespace": "", "time_ms": 1709192097031, "event_type": "POINT_IN_TIME", "key": "eval_loss", "value": 0.4212236702442169, "metadata": {"file": "mlperf_logging_utils.py", "lineno": 170, "step_num": 22}}
:::MLLOG {"namespace": "", "time_ms": 1709192097031, "event_type": "INTERVAL_START", "key": "block_start", "value": "", "metadata": {"file": "mlperf_logging_utils.py", "lineno": 175, "step_num": 22}}
:::MLLOG {"namespace": "", "time_ms": 1709192097031, "event_type": "INTERVAL_END", "key": "run_stop", "value": 0.4212236702442169, "metadata": {"file": "mlperf_logging_utils.py", "lineno": 186, "step_num": 22, "status": "success"}}
  3%|▎         | 23/800 [05:20<3:09:43, 14.65s/it]                                                  {'loss': 1.0931, 'learning_rate': 0.0004989809624342251, 'epoch': 3.83}
  3%|▎         | 23/800 [05:20<3:09:43, 14.65s/it]                                                  {'train_runtime': 320.8449, 'train_samples_per_second': 19.947, 'train_steps_per_second': 2.493, 'train_loss': 1.1554005949393562, 'epoch': 3.83}
  3%|▎         | 23/800 [05:20<3:09:43, 14.65s/it]  3%|▎         | 23/800 [05:20<3:00:40, 13.95s/it]

===================================================================================
=   BAD TERMINATION OF ONE OF YOUR APPLICATION PROCESSES
=   RANK 1 PID 128486 RUNNING AT compute23
=   KILLED BY SIGNAL: 9 (Killed)
===================================================================================

===================================================================================
=   BAD TERMINATION OF ONE OF YOUR APPLICATION PROCESSES
=   RANK 2 PID 128487 RUNNING AT compute23
=   KILLED BY SIGNAL: 9 (Killed)
===================================================================================

===================================================================================
=   BAD TERMINATION OF ONE OF YOUR APPLICATION PROCESSES
=   RANK 3 PID 128488 RUNNING AT compute23
=   KILLED BY SIGNAL: 9 (Killed)
===================================================================================

===================================================================================
=   BAD TERMINATION OF ONE OF YOUR APPLICATION PROCESSES
=   RANK 4 PID 128489 RUNNING AT compute23
=   KILLED BY SIGNAL: 9 (Killed)
===================================================================================

===================================================================================
=   BAD TERMINATION OF ONE OF YOUR APPLICATION PROCESSES
=   RANK 5 PID 128490 RUNNING AT compute23
=   KILLED BY SIGNAL: 9 (Killed)
===================================================================================

===================================================================================
=   BAD TERMINATION OF ONE OF YOUR APPLICATION PROCESSES
=   RANK 6 PID 128491 RUNNING AT compute23
=   KILLED BY SIGNAL: 9 (Killed)
===================================================================================

===================================================================================
=   BAD TERMINATION OF ONE OF YOUR APPLICATION PROCESSES
=   RANK 7 PID 128492 RUNNING AT compute23
=   KILLED BY SIGNAL: 9 (Killed)
===================================================================================
